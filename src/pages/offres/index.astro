---
import Layout from '../../layouts/Layout.astro';
import Card from '../../components/card.astro';
import { getOffres } from '../../js/backend.mjs'; 
const offres = await getOffres();
---


<Layout titre="Les offres">
    <div class ="bg-fuchsia-150">
        <h1 class = "items-center justify-center flex text-fuchsia-950 font-bold">Nos offres</h1>

        <div class ="items-center justify-center flex flex-col gap-2">
            {
            offres.map((offre) => (
                <div class="offre" data-favori={offre.favori}>
                    <!-- Contenu de l'offre -->
                    <Card offre={offre} />
                </div>
        
             ))
            }

        <a href={`/offres/surface/80`} class="bg-fuchsia-900 rounded-lg text-white p-2 no-underline hover:bg-fuchsia-800 transition">Maisons supérieures à 80m²</a>
        <a href={`/offres/prix/300000`} class="bg-fuchsia-900 rounded-lg text-white p-2 no-underline hover:bg-fuchsia-800 transition">Maisons inférieures à 300000€ </a>
        <button id="favori-button" class="bg-fuchsia-900 rounded-lg text-white p-2">Afficher les favoris</button>


        <script>
         //@ts-nocheck
            const button = document.getElementById('favori-button');
            let showOnlyFavorites = false;
    
            button?.addEventListener('click', () => {
                showOnlyFavorites = !showOnlyFavorites;
                const offres = document.querySelectorAll('.offre');
        
            offres.forEach(offre => {
                const isFavori = offre.dataset.favori === 'true';
                console.log(isFavori);
                if (showOnlyFavorites) {
                    offre.style.display = isFavori ? 'block' : 'none';
                    button.textContent = 'Afficher tout';
                } else {
                    offre.style.display = 'block';
                    button.textContent = 'Afficher les favoris';
                }
            });
        });
        </script>
        </div>
    </div>
</Layout>
